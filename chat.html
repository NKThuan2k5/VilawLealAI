<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat AI Ph√°p l√Ω - ViLaw</title>
    <meta name="description" content="Tr·ª£ l√Ω AI 24/7 cho c√¢u h·ªèi ph√°p l√Ω. Chat v·ªõi tr·ª£ l√Ω ph√°p l√Ω AI th√¥ng minh c·ªßa ViLaw.">
    
    <!-- CSS -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Icons -->
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    
    <style>
        /* CSS Variables */
        :root {
            --primary: #76BA53;
            --accent: #76819B;
            --dark: #19253F;
            --muted: #9B9CAA;
            --primary-rgba-08: rgba(118, 186, 83, 0.08);
            --accent-rgba-08: rgba(118, 129, 155, 0.08);
            --primary-rgba-18: rgba(118, 186, 83, 0.18);
        }

        /* Reset and Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            font-family: 'Inter', system-ui, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #1e293b;
            line-height: 1.6;
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        /* Animated background */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 80%, rgba(120, 119, 198, 0.2) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255, 119, 198, 0.2) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(120, 219, 255, 0.2) 0%, transparent 50%);
            animation: backgroundShift 15s ease-in-out infinite;
            z-index: -1;
        }
        
        @keyframes backgroundShift {
            0%, 100% { transform: translateX(0) translateY(0); }
            25% { transform: translateX(-15px) translateY(-5px); }
            50% { transform: translateX(15px) translateY(5px); }
            75% { transform: translateX(-5px) translateY(15px); }
        }

        /* Container */
        .container {
            max-width: 1280px;
            margin: 0 auto;
            padding: 0 1rem;
        }

        /* Header */
        .header {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(8px);
            border-bottom: 1px solid #e5e7eb;
            position: sticky;
            top: 0;
            z-index: 50;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 0;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            text-decoration: none;
            color: inherit;
        }

        .logo-icon {
            width: 5rem;
            height: 5rem;
            border-radius: 1rem;
            overflow: hidden;
            border: 1px solid var(--primary-rgba-18);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .logo-icon img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transform: scale(1.5);
        }

        .nav {
            display: flex;
            align-items: center;
            gap: 2rem;
        }

        .nav-link {
            text-decoration: none;
            color: #6b7280;
            font-weight: 500;
            transition: color 0.2s;
        }

        .nav-link:hover {
            color: var(--primary);
        }

        .nav-link.active {
            color: var(--primary);
        }

        .btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 500;
            text-decoration: none;
            transition: all 0.2s;
            border: none;
            cursor: pointer;
        }

        .btn-primary {
            background-color: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background-color: #68a547;
        }

        /* Chat Interface */
        .chat-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.5rem;
            height: calc(100vh - 80px);
            padding: 1.5rem 0;
        }

        @media (min-width: 1024px) {
            .chat-container {
                grid-template-columns: 3fr 1fr;
            }
        }

        .chat-interface {
            background: white;
            border-radius: 0.75rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            border: 1px solid #e5e7eb;
            display: flex;
            flex-direction: column;
            height: 600px;
        }

        .chat-header {
            padding: 1.5rem;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .chat-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: #111827;
        }

        .chat-actions {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .chat-action {
            padding: 0.5rem;
            border-radius: 0.5rem;
            color: #6b7280;
            cursor: pointer;
            transition: all 0.2s;
        }

        .chat-action:hover {
            background-color: #f3f4f6;
            color: #111827;
        }

        .messages-container {
            flex: 1;
            overflow-y: auto;
            padding: 1.5rem;
        }

        .message {
            margin-bottom: 1.5rem;
        }

        .message.user {
            text-align: right;
        }

        .message-content {
            display: inline-flex;
            align-items: flex-start;
            gap: 0.75rem;
            max-width: 80%;
        }

        .message.user .message-content {
            margin-left: auto;
        }

        .message-avatar {
            width: 2rem;
            height: 2rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .message.user .message-avatar {
            order: 2;
        }

        .message-avatar.ai {
            background-color: var(--primary);
            color: white;
        }

        .message-avatar.user {
            background-color: #6b7280;
            color: white;
        }

        .message-bubble {
            border-radius: 1rem;
            padding: 1rem;
            max-width: 100%;
        }

        .message.ai .message-bubble {
            background-color: #f3f4f6;
            color: #111827;
        }

        .message.user .message-bubble {
            background-color: var(--primary);
            color: white;
        }

        .message-time {
            font-size: 0.75rem;
            margin-top: 0.5rem;
        }

        .message.ai .message-time {
            color: #6b7280;
        }

        .message.user .message-time {
            color: rgba(255, 255, 255, 0.7);
        }

        .message-actions {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-top: 0.5rem;
            margin-left: 2.75rem;
        }

        .message-action {
            padding: 0.25rem;
            color: #9ca3af;
            cursor: pointer;
            transition: color 0.2s;
        }

        .message-action:hover {
            color: #6b7280;
        }

        .typing-indicator {
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
            margin-bottom: 1.5rem;
        }

        .typing-dots {
            display: flex;
            gap: 0.25rem;
            padding: 1rem;
            background-color: #f3f4f6;
            border-radius: 1rem;
        }

        .typing-dot {
            width: 0.5rem;
            height: 0.5rem;
            background-color: #9ca3af;
            border-radius: 50%;
            animation: bounce 1s infinite;
        }

        .typing-dot:nth-child(2) {
            animation-delay: 0.1s;
        }

        .typing-dot:nth-child(3) {
            animation-delay: 0.2s;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {
                transform: translateY(0);
            }
            40% {
                transform: translateY(-10px);
            }
            60% {
                transform: translateY(-5px);
            }
        }

        .chat-input {
            border-top: 1px solid #e5e7eb;
            padding: 1rem;
        }

        .input-container {
            display: flex;
            align-items: flex-end;
            gap: 0.75rem;
        }

        .input-field {
            flex: 1;
            padding: 0.75rem 1rem;
            border: 1px solid #d1d5db;
            border-radius: 0.5rem;
            resize: none;
            font-family: inherit;
            font-size: 0.875rem;
            line-height: 1.5;
        }

        .input-field:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(118, 186, 83, 0.1);
        }

        .input-button {
            padding: 0.75rem;
            border: none;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .input-button.record {
            background-color: #f3f4f6;
            color: #6b7280;
        }

        .input-button.record.active {
            background-color: #ef4444;
            color: white;
        }

        .input-button.send {
            background-color: var(--primary);
            color: white;
        }

        .input-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .suggestions-sidebar {
            background: white;
            border-radius: 0.75rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            border: 1px solid #e5e7eb;
            padding: 1.5rem;
        }

        .suggestion-item {
            width: 100%;
            text-align: left;
            padding: 0.75rem;
            border-radius: 0.5rem;
            border: 1px solid #e5e7eb;
            background: white;
            cursor: pointer;
            transition: all 0.2s;
            margin-bottom: 0.75rem;
        }

        .suggestion-item:hover {
            border-color: var(--primary);
            background-color: var(--primary-rgba-08);
        }

        .suggestion-icon {
            color: var(--primary);
            margin-right: 0.5rem;
        }

        .suggestion-text {
            font-size: 0.875rem;
            font-weight: 500;
            color: #111827;
        }

        .quick-actions {
            margin-top: 1.5rem;
            padding-top: 1.5rem;
            border-top: 1px solid #e5e7eb;
        }

        .quick-action {
            width: 100%;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem;
            border-radius: 0.5rem;
            color: #6b7280;
            cursor: pointer;
            transition: background-color 0.2s;
            background: none;
            border: none;
            text-align: left;
        }

        .quick-action:hover {
            background-color: #f3f4f6;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .nav {
                display: none;
            }

            .chat-container {
                grid-template-columns: 1fr;
            }

            .suggestions-sidebar {
                order: -1;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <a href="index.html" class="logo">
                    <div class="logo-icon">
                        <img src="assets/logo.jpg" alt="ViLaw">
                    </div>
                </a>

                <nav class="nav">
                    <a href="legal.html" class="nav-link">VƒÉn b·∫£n</a>
                    <a href="chat.html" class="nav-link active">Chat AI</a>
                    <a href="documents.html" class="nav-link">So·∫°n th·∫£o</a>
                    <a href="contract.html" class="nav-link">H·ª£p ƒë·ªìng</a>
                    <a href="dashboard.html" class="nav-link">Admin</a>
                </nav>

                <div>
                    <a href="loginuser.html" class="btn btn-primary">
                        <i data-lucide="log-in" class="w-4 h-4"></i>
                        ƒêƒÉng nh·∫≠p
                    </a>
                </div>
            </div>
        </div>
    </header>

    <!-- Chat Interface -->
    <div class="container">
        <div class="chat-container">
            <!-- Chat Interface -->
            <div class="chat-interface">
                <div class="chat-header">
                    <h1 class="chat-title">Chat AI Ph√°p l√Ω</h1>
                    <div class="chat-actions">
                        <button class="chat-action" title="B·∫≠t √¢m thanh">
                            <i data-lucide="volume-2" class="w-4 h-4"></i>
                        </button>
                        <button class="chat-action" title="C√†i ƒë·∫∑t">
                            <i data-lucide="settings" class="w-4 h-4"></i>
                        </button>
                    </div>
                </div>

                <!-- Messages -->
                <div class="messages-container" id="messagesContainer">
                    <div class="message ai">
                        <div class="message-content">
                            <div class="message-avatar ai">
                                <i data-lucide="bot" class="w-4 h-4"></i>
                            </div>
                            <div>
                                <div class="message-bubble">
                                    Xin ch√†o! T√¥i l√† tr·ª£ l√Ω ph√°p l√Ω AI c·ªßa ViLaw. T√¥i c√≥ th·ªÉ gi√∫p b·∫°n t√¨m hi·ªÉu v·ªÅ ph√°p lu·∫≠t Vi·ªát Nam, so·∫°n th·∫£o vƒÉn b·∫£n ph√°p l√Ω, v√† tr·∫£ l·ªùi c√°c c√¢u h·ªèi li√™n quan ƒë·∫øn quy·ªÅn l·ª£i c·ªßa b·∫°n. B·∫°n c√≥ th·ªÉ h·ªèi t√¥i b·∫•t c·ª© ƒëi·ªÅu g√¨!
                                </div>
                                <div class="message-time">10:30</div>
                                <div class="message-actions">
                                    <button class="message-action" title="Sao ch√©p">
                                        <i data-lucide="copy" class="w-3 h-3"></i>
                                    </button>
                                    <button class="message-action" title="Chia s·∫ª">
                                        <i data-lucide="share-2" class="w-3 h-3"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Input -->
                <div class="chat-input">
                    <div class="input-container">
                        <textarea 
                            id="messageInput" 
                            class="input-field" 
                            placeholder="Nh·∫≠p c√¢u h·ªèi ph√°p l√Ω c·ªßa b·∫°n..."
                            rows="1"
                        ></textarea>
                        
                        <button id="recordBtn" class="input-button record" title="Ghi √¢m">
                            <i data-lucide="mic" class="w-5 h-5"></i>
                        </button>
                        
                        <button id="sendBtn" class="input-button send" title="G·ª≠i tin nh·∫Øn" disabled>
                            <i data-lucide="send" class="w-5 h-5"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Suggestions Sidebar -->
            <div class="suggestions-sidebar">
                <h3 class="text-lg font-semibold text-gray-900 mb-4">G·ª£i √Ω c√¢u h·ªèi</h3>
                
                <!-- Category Filter -->
                <div class="mb-4">
                    <select id="categoryFilter" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500">
                        <option value="all">T·∫•t c·∫£ danh m·ª•c</option>
                        <option value="general">T·ªïng h·ª£p</option>
                        <option value="contract">H·ª£p ƒë·ªìng</option>
                        <option value="labor">Lao ƒë·ªông</option>
                        <option value="property">T√†i s·∫£n</option>
                        <option value="criminal">H√¨nh s·ª±</option>
                        <option value="civil">D√¢n s·ª±</option>
                    </select>
                </div>

                <!-- Suggestions -->
                <div id="suggestionsList">
                    <button class="suggestion-item" data-category="labor">
                        <div class="flex items-center space-x-2">
                            <i data-lucide="building" class="w-4 h-4 suggestion-icon"></i>
                            <span class="suggestion-text">T√¥i c√≥ quy·ªÅn g√¨ khi b·ªã sa th·∫£i tr√°i ph√©p?</span>
                        </div>
                    </button>
                    
                    <button class="suggestion-item" data-category="property">
                        <div class="flex items-center space-x-2">
                            <i data-lucide="file-text" class="w-4 h-4 suggestion-icon"></i>
                            <span class="suggestion-text">C√°ch so·∫°n th·∫£o h·ª£p ƒë·ªìng mua b√°n nh√†?</span>
                        </div>
                    </button>
                    
                    <button class="suggestion-item" data-category="general">
                        <div class="flex items-center space-x-2">
                            <i data-lucide="scale" class="w-4 h-4 suggestion-icon"></i>
                            <span class="suggestion-text">Th·ªß t·ª•c th√†nh l·∫≠p c√¥ng ty TNHH?</span>
                        </div>
                    </button>
                    
                    <button class="suggestion-item" data-category="labor">
                        <div class="flex items-center space-x-2">
                            <i data-lucide="gavel" class="w-4 h-4 suggestion-icon"></i>
                            <span class="suggestion-text">Quy·ªÅn l·ª£i ng∆∞·ªùi lao ƒë·ªông khi ngh·ªâ vi·ªác?</span>
                        </div>
                    </button>
                    
                    <button class="suggestion-item" data-category="civil">
                        <div class="flex items-center space-x-2">
                            <i data-lucide="message-square" class="w-4 h-4 suggestion-icon"></i>
                            <span class="suggestion-text">C√°ch khi·∫øu n·∫°i quy·∫øt ƒë·ªãnh h√†nh ch√≠nh?</span>
                        </div>
                    </button>
                    
                    <button class="suggestion-item" data-category="property">
                        <div class="flex items-center space-x-2">
                            <i data-lucide="book-open" class="w-4 h-4 suggestion-icon"></i>
                            <span class="suggestion-text">Th·ªß t·ª•c th·ª´a k·∫ø t√†i s·∫£n?</span>
                        </div>
                    </button>
                </div>

                <!-- Quick Actions -->
                <div class="quick-actions">
                    <h4 class="text-sm font-medium text-gray-900 mb-3">Thao t√°c nhanh</h4>
                    <div class="space-y-2">
                        <button class="quick-action">
                            <i data-lucide="download" class="w-4 h-4"></i>
                            <span class="text-sm">T·∫£i l·ªãch s·ª≠ chat</span>
                        </button>
                        <button class="quick-action">
                            <i data-lucide="rotate-ccw" class="w-4 h-4"></i>
                            <span class="text-sm">B·∫Øt ƒë·∫ßu l·∫°i</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script>
        // Chat functionality
        class ChatApp {
            constructor() {
                this.messages = [];
                this.isTyping = false;
                this.isRecording = false;
                this.isMuted = false;
                this.selectedCategory = 'all';
                this.legalData = [];
                this.aiModel = null;
                
                this.initializeElements();
                this.bindEvents();
                this.loadMessages();
                this.loadLegalData();
                this.initializeAI();
            }
            
            initializeElements() {
                this.messagesContainer = document.getElementById('messagesContainer');
                this.messageInput = document.getElementById('messageInput');
                this.sendBtn = document.getElementById('sendBtn');
                this.recordBtn = document.getElementById('recordBtn');
                this.categoryFilter = document.getElementById('categoryFilter');
                this.suggestionsList = document.getElementById('suggestionsList');
                
                // Debug: Check if elements exist
                console.log('Messages container:', this.messagesContainer);
                console.log('Message input:', this.messageInput);
                console.log('Send button:', this.sendBtn);
                
                if (!this.messagesContainer) {
                    console.error('Messages container not found!');
                }
                if (!this.messageInput) {
                    console.error('Message input not found!');
                }
                if (!this.sendBtn) {
                    console.error('Send button not found!');
                }
            }
            
            bindEvents() {
                console.log('Binding events...');
                
                // Send button
                if (this.sendBtn) {
                    console.log('Adding send button listener');
                    this.sendBtn.addEventListener('click', (e) => {
                        e.preventDefault();
                        console.log('Send button clicked');
                        this.sendMessage();
                    });
                } else {
                    console.error('Send button not found!');
                }
                
                // Record button
                if (this.recordBtn) {
                    console.log('Adding record button listener');
                    this.recordBtn.addEventListener('click', () => this.toggleRecording());
                }
                
                // Category filter
                if (this.categoryFilter) {
                    console.log('Adding category filter listener');
                    this.categoryFilter.addEventListener('change', (e) => this.filterSuggestions(e.target.value));
                }
                
                // Message input
                if (this.messageInput) {
                    console.log('Adding message input listeners');
                    this.messageInput.addEventListener('keypress', (e) => {
                        if (e.key === 'Enter' && !e.shiftKey) {
                            e.preventDefault();
                            console.log('Enter key pressed');
                            this.sendMessage();
                        }
                    });
                    
                    this.messageInput.addEventListener('input', () => {
                        if (this.sendBtn) {
                            this.sendBtn.disabled = !this.messageInput.value.trim();
                        }
                        // Auto-resize textarea
                        this.messageInput.style.height = 'auto';
                        this.messageInput.style.height = this.messageInput.scrollHeight + 'px';
                    });
                } else {
                    console.error('Message input not found!');
                }
                
                // Suggestion clicks
                if (this.suggestionsList) {
                    console.log('Adding suggestions listener');
                    this.suggestionsList.addEventListener('click', (e) => {
                        const suggestion = e.target.closest('.suggestion-item');
                        if (suggestion) {
                            const text = suggestion.querySelector('.suggestion-text').textContent;
                            if (this.messageInput) {
                                this.messageInput.value = text;
                                this.sendMessage();
                            }
                        }
                    });
                }
                
                console.log('Events bound successfully');
            }
            
            loadMessages() {
                const saved = localStorage.getItem('vilaw_chat_messages');
                if (saved) {
                    this.messages = JSON.parse(saved);
                    this.renderMessages();
                } else {
                    // Add welcome message
                    this.addMessage('ai', 'Xin ch√†o! T√¥i l√† tr·ª£ l√Ω ph√°p l√Ω AI c·ªßa ViLaw. T√¥i c√≥ th·ªÉ gi√∫p b·∫°n t√¨m hi·ªÉu v·ªÅ ph√°p lu·∫≠t Vi·ªát Nam, so·∫°n th·∫£o vƒÉn b·∫£n ph√°p l√Ω, v√† tr·∫£ l·ªùi c√°c c√¢u h·ªèi li√™n quan ƒë·∫øn quy·ªÅn l·ª£i c·ªßa b·∫°n. B·∫°n c√≥ th·ªÉ h·ªèi t√¥i b·∫•t c·ª© ƒëi·ªÅu g√¨!');
                }
            }
            
            saveMessages() {
                localStorage.setItem('vilaw_chat_messages', JSON.stringify(this.messages));
            }
            
            addMessage(type, content) {
                const message = {
                    id: Date.now().toString(),
                    type,
                    content,
                    timestamp: new Date()
                };
                
                this.messages.push(message);
                this.saveMessages();
                this.renderMessages();
                this.scrollToBottom();
            }
            
            renderMessages() {
                this.messagesContainer.innerHTML = '';
                
                this.messages.forEach(message => {
                    const messageEl = this.createMessageElement(message);
                    this.messagesContainer.appendChild(messageEl);
                });
            }
            
            createMessageElement(message) {
                const messageDiv = document.createElement('div');
                messageDiv.className = `message ${message.type}`;
                
                const time = message.timestamp.toLocaleTimeString('vi-VN', {
                    hour: '2-digit',
                    minute: '2-digit'
                });
                
                messageDiv.innerHTML = `
                    <div class="message-content">
                        ${message.type === 'ai' ? `
                            <div class="message-avatar ai">
                                <i data-lucide="bot" class="w-4 h-4"></i>
                            </div>
                        ` : ''}
                        <div>
                            <div class="message-bubble">${message.content}</div>
                            <div class="message-time">${time}</div>
                            ${message.type === 'ai' ? `
                                <div class="message-actions">
                                    <button class="message-action" onclick="chatApp.copyMessage('${message.id}')" title="Sao ch√©p">
                                        <i data-lucide="copy" class="w-3 h-3"></i>
                                    </button>
                                    <button class="message-action" onclick="chatApp.shareMessage('${message.id}')" title="Chia s·∫ª">
                                        <i data-lucide="share-2" class="w-3 h-3"></i>
                                    </button>
                                </div>
                            ` : ''}
                        </div>
                        ${message.type === 'user' ? `
                            <div class="message-avatar user">
                                <i data-lucide="user" class="w-4 h-4"></i>
                            </div>
                        ` : ''}
                    </div>
                `;
                
                return messageDiv;
            }
            
            sendMessage() {
                console.log('sendMessage called');
                
                if (!this.messageInput) {
                    console.error('Message input not found in sendMessage');
                    return;
                }
                
                const content = this.messageInput.value.trim();
                console.log('Message content:', content);
                
                if (!content) {
                    console.log('No content to send');
                    return;
                }
                
                console.log('Sending message:', content);
                this.addMessage('user', content);
                this.messageInput.value = '';
                
                if (this.sendBtn) {
                    this.sendBtn.disabled = true;
                }
                
                this.showTyping();
                this.generateAIResponse(content);
            }
            
            showTyping() {
                this.isTyping = true;
                const typingEl = document.createElement('div');
                typingEl.className = 'typing-indicator';
                typingEl.id = 'typingIndicator';
                typingEl.innerHTML = `
                    <div class="message-avatar ai">
                        <i data-lucide="bot" class="w-4 h-4"></i>
                    </div>
                    <div class="typing-dots">
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                    </div>
                `;
                
                this.messagesContainer.appendChild(typingEl);
                this.scrollToBottom();
            }
            
            hideTyping() {
                this.isTyping = false;
                const typingEl = document.getElementById('typingIndicator');
                if (typingEl) {
                    typingEl.remove();
                }
            }
            
            async generateAIResponse(userInput) {
                try {
                    console.log('Generating AI response for:', userInput);
                    
                    // Simulate API delay
                    await new Promise(resolve => setTimeout(resolve, 1000 + Math.random() * 2000));
                    
                    // Analyze user input and find relevant legal documents
                    const relevantDocs = this.findRelevantDocuments(userInput);
                    const response = this.generateContextualResponse(userInput, relevantDocs);
                    
                    console.log('AI response generated:', response);
                    this.addMessage('ai', response);
                } catch (error) {
                    console.error('AI response error:', error);
                    this.addMessage('ai', 'Xin l·ªói, c√≥ l·ªói x·∫£y ra khi x·ª≠ l√Ω c√¢u h·ªèi c·ªßa b·∫°n. Vui l√≤ng th·ª≠ l·∫°i sau.');
                } finally {
                    this.hideTyping();
                }
            }
            
            loadLegalData() {
                // Load legal data from localStorage or API
                const savedData = localStorage.getItem('vilaw_legal_data');
                if (savedData) {
                    this.legalData = JSON.parse(savedData);
                    console.log(`ƒê√£ t·∫£i ${this.legalData.length} vƒÉn b·∫£n ph√°p lu·∫≠t`);
                } else {
                    // Load sample data
                    this.legalData = this.getSampleLegalData();
                }
            }
            
            initializeAI() {
                // Initialize AI model with legal data
                this.aiModel = {
                    accuracy: 98.5,
                    lastTraining: new Date().toISOString(),
                    dataCount: this.legalData.length
                };
            }
            
            findRelevantDocuments(userInput) {
                const keywords = this.extractKeywords(userInput);
                const relevantDocs = [];
                
                for (const doc of this.legalData) {
                    const relevanceScore = this.calculateRelevanceScore(userInput, doc);
                    if (relevanceScore > 0.3) {
                        relevantDocs.push({
                            ...doc,
                            relevanceScore
                        });
                    }
                }
                
                return relevantDocs
                    .sort((a, b) => b.relevanceScore - a.relevanceScore)
                    .slice(0, 3);
            }
            
            calculateRelevanceScore(userInput, document) {
                const input = userInput.toLowerCase();
                const title = document.title.toLowerCase();
                const content = document.content.toLowerCase();
                const keywords = document.keywords || [];
                
                let score = 0;
                
                // Title match (highest weight)
                if (title.includes(input)) {
                    score += 0.8;
                }
                
                // Keyword matches
                for (const keyword of keywords) {
                    if (input.includes(keyword.toLowerCase())) {
                        score += 0.6;
                    }
                }
                
                // Content word matches
                const inputWords = input.split(/\s+/).filter(word => word.length > 2);
                const contentWords = content.split(/\s+/);
                
                let wordMatches = 0;
                for (const word of inputWords) {
                    if (contentWords.includes(word)) {
                        wordMatches++;
                    }
                }
                
                score += (wordMatches / inputWords.length) * 0.4;
                
                // Partial matches
                for (const word of inputWords) {
                    for (const contentWord of contentWords) {
                        if (contentWord.includes(word) || word.includes(contentWord)) {
                            score += 0.1;
                        }
                    }
                }
                
                return Math.min(score, 1.0);
            }
            
            extractKeywords(text) {
                return text.toLowerCase()
                    .replace(/[^\w\s\u00C0-\u1EF9]/g, '')
                    .split(/\s+/)
                    .filter(word => word.length > 2);
            }
            
            generateContextualResponse(userInput, relevantDocs) {
                // Analyze user intent
                const intent = this.analyzeUserIntent(userInput);
                
                if (relevantDocs.length === 0) {
                    return this.generateGeneralResponse(userInput, intent);
                }
                
                const topDoc = relevantDocs[0];
                let response = this.generateStructuredResponse(userInput, topDoc, relevantDocs, intent);
                
                return response;
            }
            
            analyzeUserIntent(userInput) {
                const input = userInput.toLowerCase();
                
                // Hi·∫øn ph√°p v√† lu·∫≠t c∆° b·∫£n
                if (input.includes('hi·∫øn ph√°p') || input.includes('c∆° b·∫£n') || input.includes('quy·ªÅn c√¥ng d√¢n')) {
                    return 'constitutional_inquiry';
                }
                // Lu·∫≠t h√¨nh s·ª±
                else if (input.includes('h√¨nh s·ª±') || input.includes('t·ªôi ph·∫°m') || input.includes('h√¨nh ph·∫°t') || input.includes('t·ªë t·ª•ng h√¨nh s·ª±')) {
                    return 'criminal_inquiry';
                }
                // Lu·∫≠t d√¢n s·ª±
                else if (input.includes('d√¢n s·ª±') || input.includes('t·ªë t·ª•ng d√¢n s·ª±') || input.includes('s·ªü h·ªØu') || input.includes('th·ª´a k·∫ø')) {
                    return 'civil_inquiry';
                }
                // Lu·∫≠t lao ƒë·ªông
                else if (input.includes('lao ƒë·ªông') || input.includes('vi·ªác l√†m') || input.includes('l∆∞∆°ng') || input.includes('ngh·ªâ ph√©p')) {
                    return 'labor_inquiry';
                }
                // Lu·∫≠t doanh nghi·ªáp
                else if (input.includes('doanh nghi·ªáp') || input.includes('c√¥ng ty') || input.includes('th√†nh l·∫≠p') || input.includes('kinh doanh')) {
                    return 'business_inquiry';
                }
                // Lu·∫≠t h√¥n nh√¢n gia ƒë√¨nh
                else if (input.includes('h√¥n nh√¢n') || input.includes('gia ƒë√¨nh') || input.includes('v·ª£ ch·ªìng') || input.includes('cha m·∫π')) {
                    return 'family_inquiry';
                }
                // Lu·∫≠t ƒë·∫•t ƒëai, nh√† ·ªü
                else if (input.includes('ƒë·∫•t ƒëai') || input.includes('nh√† ·ªü') || input.includes('b·∫•t ƒë·ªông s·∫£n') || input.includes('mua b√°n nh√†')) {
                    return 'property_inquiry';
                }
                // Lu·∫≠t an ninh m·∫°ng
                else if (input.includes('an ninh m·∫°ng') || input.includes('b·∫£o m·∫≠t') || input.includes('d·ªØ li·ªáu c√° nh√¢n') || input.includes('quy·ªÅn ri√™ng t∆∞')) {
                    return 'cybersecurity_inquiry';
                }
                // B·∫£o hi·ªÉm x√£ h·ªôi
                else if (input.includes('b·∫£o hi·ªÉm') || input.includes('x√£ h·ªôi') || input.includes('h∆∞u tr√≠') || input.includes('th·∫•t nghi·ªáp')) {
                    return 'social_insurance_inquiry';
                }
                // Thu·∫ø
                else if (input.includes('thu·∫ø') || input.includes('khai thu·∫ø') || input.includes('n·ªôp thu·∫ø') || input.includes('ho√†n thu·∫ø')) {
                    return 'tax_inquiry';
                }
                // Giao th√¥ng
                else if (input.includes('giao th√¥ng') || input.includes('x·ª≠ ph·∫°t') || input.includes('vi ph·∫°m') || input.includes('ƒë∆∞·ªùng b·ªô')) {
                    return 'traffic_inquiry';
                }
                // COVID-19
                else if (input.includes('covid') || input.includes('d·ªãch b·ªánh') || input.includes('gi√£n c√°ch') || input.includes('h·ªó tr·ª£')) {
                    return 'covid_inquiry';
                }
                // H·ª£p ƒë·ªìng
                else if (input.includes('h·ª£p ƒë·ªìng') || input.includes('th·ªèa thu·∫≠n') || input.includes('k√Ω k·∫øt') || input.includes('giao d·ªãch')) {
                    return 'contract_inquiry';
                }
                // Ngh·ªã ƒë·ªãnh, ngh·ªã quy·∫øt
                else if (input.includes('ngh·ªã ƒë·ªãnh') || input.includes('ngh·ªã quy·∫øt') || input.includes('ch·ªâ th·ªã') || input.includes('quy·∫øt ƒë·ªãnh')) {
                    return 'administrative_inquiry';
                }
                // Th√¥ng t∆∞
                else if (input.includes('th√¥ng t∆∞') || input.includes('h∆∞·ªõng d·∫´n') || input.includes('th·ª±c hi·ªán')) {
                    return 'circular_inquiry';
                }
                // Lu·∫≠t chung
                else if (input.includes('lu·∫≠t') || input.includes('quy ƒë·ªãnh') || input.includes('ph√°p lu·∫≠t')) {
                    return 'legal_inquiry';
                } else {
                    return 'general_inquiry';
                }
            }
            
            generateGeneralResponse(userInput, intent) {
                const responses = {
                    'constitutional_inquiry': 'V·ªÅ Hi·∫øn ph√°p v√† quy·ªÅn c∆° b·∫£n c·ªßa c√¥ng d√¢n, t√¥i c√≥ th·ªÉ cung c·∫•p th√¥ng tin v·ªÅ c√°c quy·ªÅn v√† nghƒ©a v·ª• ƒë∆∞·ª£c quy ƒë·ªãnh trong Hi·∫øn ph√°p. B·∫°n c√≥ th·ªÉ h·ªèi c·ª• th·ªÉ v·ªÅ quy·ªÅn n√†o?',
                    'criminal_inquiry': 'V·ªÅ lu·∫≠t h√¨nh s·ª± v√† t·ªë t·ª•ng h√¨nh s·ª±, t√¥i c√≥ th·ªÉ gi√∫p b·∫°n hi·ªÉu c√°c quy ƒë·ªãnh v·ªÅ t·ªôi ph·∫°m, h√¨nh ph·∫°t v√† th·ªß t·ª•c t·ªë t·ª•ng. B·∫°n c√≥ th·ªÉ m√¥ t·∫£ t√¨nh hu·ªëng c·ª• th·ªÉ kh√¥ng?',
                    'civil_inquiry': 'V·ªÅ lu·∫≠t d√¢n s·ª± v√† t·ªë t·ª•ng d√¢n s·ª±, t√¥i c√≥ th·ªÉ h·ªó tr·ª£ b·∫°n t√¨m hi·ªÉu v·ªÅ quy·ªÅn s·ªü h·ªØu, th·ª´a k·∫ø, h·ª£p ƒë·ªìng d√¢n s·ª±. B·∫°n ƒëang quan t√¢m ƒë·∫øn v·∫•n ƒë·ªÅ g√¨?',
                    'labor_inquiry': 'V·ªÅ quy·ªÅn lao ƒë·ªông, t√¥i c√≥ th·ªÉ cung c·∫•p th√¥ng tin v·ªÅ c√°c quy ƒë·ªãnh li√™n quan ƒë·∫øn quan h·ªá lao ƒë·ªông, ti·ªÅn l∆∞∆°ng, th·ªùi gi·ªù l√†m vi·ªác. B·∫°n c√≥ th·ªÉ chia s·∫ª th√™m v·ªÅ t√¨nh hu·ªëng c·ª• th·ªÉ kh√¥ng?',
                    'business_inquiry': 'V·ªÅ ph√°p lu·∫≠t doanh nghi·ªáp, t√¥i c√≥ th·ªÉ h·ªó tr·ª£ b·∫°n t√¨m hi·ªÉu v·ªÅ th√†nh l·∫≠p, qu·∫£n l√Ω, ho·∫°t ƒë·ªông doanh nghi·ªáp. B·∫°n ƒëang quan t√¢m ƒë·∫øn kh√≠a c·∫°nh n√†o c·ª• th·ªÉ?',
                    'family_inquiry': 'V·ªÅ ph√°p lu·∫≠t h√¥n nh√¢n v√† gia ƒë√¨nh, t√¥i c√≥ th·ªÉ cung c·∫•p th√¥ng tin v·ªÅ quy·ªÅn v√† nghƒ©a v·ª• c·ªßa c√°c th√†nh vi√™n gia ƒë√¨nh. B·∫°n c√≥ th·ªÉ m√¥ t·∫£ t√¨nh hu·ªëng c·ª• th·ªÉ kh√¥ng?',
                    'property_inquiry': 'V·ªÅ lu·∫≠t ƒë·∫•t ƒëai v√† nh√† ·ªü, t√¥i c√≥ th·ªÉ gi√∫p b·∫°n hi·ªÉu v·ªÅ quy·ªÅn s·ªü h·ªØu, s·ª≠ d·ª•ng ƒë·∫•t ƒëai v√† nh√† ·ªü. B·∫°n c√≥ th·ªÉ chia s·∫ª th√™m chi ti·∫øt kh√¥ng?',
                    'cybersecurity_inquiry': 'V·ªÅ lu·∫≠t an ninh m·∫°ng v√† b·∫£o v·ªá d·ªØ li·ªáu c√° nh√¢n, t√¥i c√≥ th·ªÉ cung c·∫•p th√¥ng tin v·ªÅ c√°c quy ƒë·ªãnh b·∫£o v·ªá th√¥ng tin. B·∫°n c√≥ th·ªÉ h·ªèi c·ª• th·ªÉ v·ªÅ v·∫•n ƒë·ªÅ g√¨?',
                    'social_insurance_inquiry': 'V·ªÅ b·∫£o hi·ªÉm x√£ h·ªôi, t√¥i c√≥ th·ªÉ gi√∫p b·∫°n hi·ªÉu v·ªÅ c√°c ch·∫ø ƒë·ªô, ch√≠nh s√°ch b·∫£o hi·ªÉm. B·∫°n c√≥ th·ªÉ m√¥ t·∫£ t√¨nh hu·ªëng c·ª• th·ªÉ kh√¥ng?',
                    'tax_inquiry': 'V·ªÅ thu·∫ø v√† qu·∫£n l√Ω thu·∫ø, t√¥i c√≥ th·ªÉ h·ªó tr·ª£ b·∫°n t√¨m hi·ªÉu v·ªÅ c√°c quy ƒë·ªãnh khai thu·∫ø, n·ªôp thu·∫ø, ho√†n thu·∫ø. B·∫°n ƒëang quan t√¢m ƒë·∫øn lo·∫°i thu·∫ø n√†o?',
                    'traffic_inquiry': 'V·ªÅ lu·∫≠t giao th√¥ng v√† x·ª≠ ph·∫°t vi ph·∫°m, t√¥i c√≥ th·ªÉ cung c·∫•p th√¥ng tin v·ªÅ c√°c quy ƒë·ªãnh giao th√¥ng v√† m·ª©c ph·∫°t. B·∫°n c√≥ th·ªÉ m√¥ t·∫£ t√¨nh hu·ªëng c·ª• th·ªÉ kh√¥ng?',
                    'covid_inquiry': 'V·ªÅ c√°c quy ƒë·ªãnh ph√≤ng ch·ªëng COVID-19, t√¥i c√≥ th·ªÉ cung c·∫•p th√¥ng tin v·ªÅ c√°c bi·ªán ph√°p ph√≤ng ch·ªëng d·ªãch v√† h·ªó tr·ª£. B·∫°n c√≥ th·ªÉ h·ªèi c·ª• th·ªÉ v·ªÅ v·∫•n ƒë·ªÅ g√¨?',
                    'contract_inquiry': 'V·ªÅ h·ª£p ƒë·ªìng v√† th·ªèa thu·∫≠n, t√¥i c√≥ th·ªÉ gi√∫p b·∫°n hi·ªÉu c√°c quy ƒë·ªãnh v·ªÅ k√Ω k·∫øt, th·ª±c hi·ªán h·ª£p ƒë·ªìng. B·∫°n c√≥ th·ªÉ m√¥ t·∫£ c·ª• th·ªÉ v·ªÅ lo·∫°i h·ª£p ƒë·ªìng kh√¥ng?',
                    'administrative_inquiry': 'V·ªÅ ngh·ªã ƒë·ªãnh, ngh·ªã quy·∫øt, ch·ªâ th·ªã, quy·∫øt ƒë·ªãnh, t√¥i c√≥ th·ªÉ cung c·∫•p th√¥ng tin v·ªÅ c√°c vƒÉn b·∫£n h√†nh ch√≠nh. B·∫°n c√≥ th·ªÉ h·ªèi c·ª• th·ªÉ v·ªÅ vƒÉn b·∫£n n√†o?',
                    'circular_inquiry': 'V·ªÅ th√¥ng t∆∞ v√† h∆∞·ªõng d·∫´n th·ª±c hi·ªán, t√¥i c√≥ th·ªÉ gi√∫p b·∫°n hi·ªÉu c√°c quy ƒë·ªãnh chi ti·∫øt. B·∫°n c√≥ th·ªÉ m√¥ t·∫£ v·∫•n ƒë·ªÅ c·ª• th·ªÉ kh√¥ng?',
                    'legal_inquiry': 'T√¥i hi·ªÉu b·∫°n ƒëang t√¨m hi·ªÉu v·ªÅ ph√°p lu·∫≠t. ƒê·ªÉ h·ªó tr·ª£ t·ªët nh·∫•t, b·∫°n c√≥ th·ªÉ cung c·∫•p th√™m chi ti·∫øt v·ªÅ lƒ©nh v·ª±c ph√°p lu·∫≠t c·ª• th·ªÉ m√† b·∫°n quan t√¢m kh√¥ng?',
                    'general_inquiry': 'T√¥i l√† tr·ª£ l√Ω ph√°p l√Ω AI c·ªßa ViLaw. T√¥i c√≥ th·ªÉ gi√∫p b·∫°n t√¨m hi·ªÉu v·ªÅ t·∫•t c·∫£ c√°c lo·∫°i vƒÉn b·∫£n ph√°p lu·∫≠t Vi·ªát Nam: Lu·∫≠t, Ngh·ªã ƒë·ªãnh, Ngh·ªã quy·∫øt, Th√¥ng t∆∞, Quy·∫øt ƒë·ªãnh, Ch·ªâ th·ªã, H·ª£p ƒë·ªìng m·∫´u. B·∫°n c√≥ th·ªÉ h·ªèi t√¥i v·ªÅ b·∫•t k·ª≥ v·∫•n ƒë·ªÅ ph√°p l√Ω n√†o!'
                };
                
                return responses[intent] || responses['general_inquiry'];
            }
            
            generateStructuredResponse(userInput, topDoc, relevantDocs, intent) {
                let response = `D·ª±a tr√™n ${relevantDocs.length} vƒÉn b·∫£n ph√°p lu·∫≠t li√™n quan, t√¥i c√≥ th·ªÉ gi√∫p b·∫°n nh∆∞ sau:\n\n`;
                
                response += `üìã **${topDoc.title}**\n`;
                response += `üìÖ Ng√†y ban h√†nh: ${new Date(topDoc.date).toLocaleDateString('vi-VN')}\n`;
                response += `üìÇ Lo·∫°i: ${topDoc.type}\n`;
                response += `üèõÔ∏è Ngu·ªìn: ${topDoc.source}\n\n`;
                
                // Add specific guidance based on intent
                response += this.addIntentSpecificGuidance(intent, topDoc);
                
                response += `**N·ªôi dung li√™n quan:**\n`;
                response += this.extractRelevantContent(userInput, topDoc.content);
                
                if (relevantDocs.length > 1) {
                    response += `\n\n**C√°c vƒÉn b·∫£n kh√°c li√™n quan:**\n`;
                    for (let i = 1; i < relevantDocs.length; i++) {
                        response += `‚Ä¢ ${relevantDocs[i].title} (${relevantDocs[i].type})\n`;
                    }
                }
                
                response += `\n\n‚ö†Ô∏è **L∆∞u √Ω:** Th√¥ng tin tr√™n ch·ªâ mang t√≠nh ch·∫•t tham kh·∫£o. ƒê·ªÉ c√≥ c√¢u tr·∫£ l·ªùi ch√≠nh x√°c nh·∫•t, b·∫°n n√™n tham kh·∫£o √Ω ki·∫øn c·ªßa lu·∫≠t s∆∞ chuy√™n nghi·ªáp.`;
                
                return response;
            }
            
            addIntentSpecificGuidance(intent, doc) {
                const guidance = {
                    'constitutional_inquiry': `ƒê√¢y l√† Hi·∫øn ph√°p - lu·∫≠t c∆° b·∫£n c√≥ hi·ªáu l·ª±c ph√°p l√Ω cao nh·∫•t. B·∫°n n√™n ƒë·ªçc k·ªπ c√°c quy ƒë·ªãnh v·ªÅ quy·ªÅn v√† nghƒ©a v·ª• c∆° b·∫£n c·ªßa c√¥ng d√¢n.\n\n`,
                    'criminal_inquiry': `VƒÉn b·∫£n n√†y quy ƒë·ªãnh v·ªÅ t·ªôi ph·∫°m v√† h√¨nh ph·∫°t. B·∫°n n√™n ch√∫ √Ω ƒë·∫øn c√°c ƒëi·ªÅu ki·ªán c·∫•u th√†nh t·ªôi ph·∫°m v√† m·ª©c h√¨nh ph·∫°t.\n\n`,
                    'civil_inquiry': `VƒÉn b·∫£n n√†y quy ƒë·ªãnh v·ªÅ quan h·ªá d√¢n s·ª±. B·∫°n n√™n xem x√©t c√°c quy·ªÅn v√† nghƒ©a v·ª• c·ªßa c√°c b√™n trong quan h·ªá d√¢n s·ª±.\n\n`,
                    'labor_inquiry': `VƒÉn b·∫£n n√†y quy ƒë·ªãnh v·ªÅ quy·ªÅn v√† nghƒ©a v·ª• lao ƒë·ªông. B·∫°n n√™n xem x√©t c√°c ƒëi·ªÅu kho·∫£n li√™n quan ƒë·∫øn t√¨nh hu·ªëng lao ƒë·ªông c·ªßa m√¨nh.\n\n`,
                    'business_inquiry': `ƒê√¢y l√† vƒÉn b·∫£n quy ƒë·ªãnh v·ªÅ ho·∫°t ƒë·ªông doanh nghi·ªáp. H√£y ch√∫ √Ω ƒë·∫øn c√°c y√™u c·∫ßu v√† th·ªß t·ª•c ph√°p l√Ω khi th√†nh l·∫≠p, qu·∫£n l√Ω doanh nghi·ªáp.\n\n`,
                    'family_inquiry': `VƒÉn b·∫£n n√†y quy ƒë·ªãnh v·ªÅ quan h·ªá h√¥n nh√¢n v√† gia ƒë√¨nh. B·∫°n n√™n xem x√©t c√°c ƒëi·ªÅu ki·ªán v√† quy·ªÅn l·ª£i ƒë∆∞·ª£c quy ƒë·ªãnh cho c√°c th√†nh vi√™n gia ƒë√¨nh.\n\n`,
                    'property_inquiry': `VƒÉn b·∫£n n√†y quy ƒë·ªãnh v·ªÅ quy·ªÅn s·ªü h·ªØu, s·ª≠ d·ª•ng ƒë·∫•t ƒëai v√† nh√† ·ªü. H√£y ch√∫ √Ω ƒë·∫øn c√°c ƒëi·ªÅu ki·ªán v√† th·ªß t·ª•c ph√°p l√Ω.\n\n`,
                    'cybersecurity_inquiry': `VƒÉn b·∫£n n√†y quy ƒë·ªãnh v·ªÅ b·∫£o v·ªá an ninh m·∫°ng v√† d·ªØ li·ªáu c√° nh√¢n. B·∫°n n√™n ch√∫ √Ω ƒë·∫øn c√°c nghƒ©a v·ª• b·∫£o v·ªá th√¥ng tin.\n\n`,
                    'social_insurance_inquiry': `VƒÉn b·∫£n n√†y quy ƒë·ªãnh v·ªÅ ch·∫ø ƒë·ªô b·∫£o hi·ªÉm x√£ h·ªôi. B·∫°n n√™n xem x√©t c√°c quy·ªÅn l·ª£i v√† nghƒ©a v·ª• ƒë√≥ng b·∫£o hi·ªÉm.\n\n`,
                    'tax_inquiry': `VƒÉn b·∫£n n√†y quy ƒë·ªãnh v·ªÅ qu·∫£n l√Ω thu·∫ø. B·∫°n n√™n ch√∫ √Ω ƒë·∫øn c√°c th·ªß t·ª•c khai thu·∫ø, n·ªôp thu·∫ø v√† ho√†n thu·∫ø.\n\n`,
                    'traffic_inquiry': `VƒÉn b·∫£n n√†y quy ƒë·ªãnh v·ªÅ x·ª≠ ph·∫°t vi ph·∫°m giao th√¥ng. B·∫°n n√™n ch√∫ √Ω ƒë·∫øn c√°c m·ª©c ph·∫°t v√† th·ªß t·ª•c x·ª≠ ph·∫°t.\n\n`,
                    'covid_inquiry': `VƒÉn b·∫£n n√†y quy ƒë·ªãnh v·ªÅ c√°c bi·ªán ph√°p ph√≤ng ch·ªëng COVID-19. B·∫°n n√™n ch√∫ √Ω ƒë·∫øn c√°c quy ƒë·ªãnh v·ªÅ gi√£n c√°ch v√† h·ªó tr·ª£.\n\n`,
                    'contract_inquiry': `VƒÉn b·∫£n n√†y c√≥ th·ªÉ ch·ª©a c√°c quy ƒë·ªãnh v·ªÅ h·ª£p ƒë·ªìng. H√£y ch√∫ √Ω ƒë·∫øn c√°c ƒëi·ªÅu ki·ªán v√† nghƒ©a v·ª• c·ªßa c√°c b√™n.\n\n`,
                    'administrative_inquiry': `ƒê√¢y l√† vƒÉn b·∫£n h√†nh ch√≠nh c√≥ hi·ªáu l·ª±c thi h√†nh. B·∫°n n√™n ch√∫ √Ω ƒë·∫øn c√°c quy ƒë·ªãnh v√† th·ªß t·ª•c th·ª±c hi·ªán.\n\n`,
                    'circular_inquiry': `ƒê√¢y l√† th√¥ng t∆∞ h∆∞·ªõng d·∫´n th·ª±c hi·ªán. B·∫°n n√™n ch√∫ √Ω ƒë·∫øn c√°c quy ƒë·ªãnh chi ti·∫øt v√† th·ªß t·ª•c c·ª• th·ªÉ.\n\n`,
                    'legal_inquiry': `ƒê√¢y l√† vƒÉn b·∫£n ph√°p lu·∫≠t ch√≠nh th·ª©c c√≥ hi·ªáu l·ª±c. B·∫°n n√™n ƒë·ªçc k·ªπ c√°c ƒëi·ªÅu kho·∫£n li√™n quan ƒë·∫øn c√¢u h·ªèi c·ªßa m√¨nh.\n\n`
                };
                
                return guidance[intent] || '';
            }
            
            extractRelevantContent(userInput, content) {
                // Simple content extraction - in real implementation, this would be more sophisticated
                const sentences = content.split(/[.!?]+/);
                const relevantSentences = sentences.filter(sentence => 
                    sentence.toLowerCase().includes(userInput.toLowerCase()) ||
                    this.calculateRelevanceScore(userInput, { content: sentence }) > 0.2
                );
                
                return relevantSentences.slice(0, 3).join('. ') + '.';
            }
            
            getSampleLegalData() {
                return [
                    // LU·∫¨T C∆† B·∫¢N
                    {
                        id: 'doc_1',
                        title: 'Hi·∫øn ph√°p n∆∞·ªõc C·ªông h√≤a x√£ h·ªôi ch·ªß nghƒ©a Vi·ªát Nam 2013',
                        content: 'Hi·∫øn ph√°p l√† lu·∫≠t c∆° b·∫£n c·ªßa n∆∞·ªõc C·ªông h√≤a x√£ h·ªôi ch·ªß nghƒ©a Vi·ªát Nam, c√≥ hi·ªáu l·ª±c ph√°p l√Ω cao nh·∫•t. Hi·∫øn ph√°p quy ƒë·ªãnh v·ªÅ ch·∫ø ƒë·ªô ch√≠nh tr·ªã, kinh t·∫ø, vƒÉn h√≥a, x√£ h·ªôi, qu·ªëc ph√≤ng, an ninh, quy·ªÅn v√† nghƒ©a v·ª• c∆° b·∫£n c·ªßa c√¥ng d√¢n, c∆° c·∫•u, nguy√™n t·∫Øc t·ªï ch·ª©c v√† ho·∫°t ƒë·ªông c·ªßa c√°c c∆° quan nh√† n∆∞·ªõc.',
                        type: 'Hi·∫øn ph√°p',
                        source: 'Qu·ªëc h·ªôi',
                        date: '2013-11-28T00:00:00.000Z',
                        keywords: ['hi·∫øn ph√°p', 'c∆° b·∫£n', 'quy·ªÅn', 'nghƒ©a v·ª•', 'c√¥ng d√¢n', 'nh√† n∆∞·ªõc'],
                        category: 'hien-phap'
                    },
                    {
                        id: 'doc_2',
                        title: 'Lu·∫≠t Doanh nghi·ªáp 2020',
                        content: 'Lu·∫≠t n√†y quy ƒë·ªãnh v·ªÅ vi·ªác th√†nh l·∫≠p, qu·∫£n l√Ω, t·ªï ch·ª©c l·∫°i, gi·∫£i th·ªÉ doanh nghi·ªáp; quy·ªÅn v√† nghƒ©a v·ª• c·ªßa ch·ªß s·ªü h·ªØu, th√†nh vi√™n, c·ªï ƒë√¥ng c·ªßa doanh nghi·ªáp. Doanh nghi·ªáp c√≥ quy·ªÅn t·ª± do kinh doanh trong nh·ªØng ng√†nh, ngh·ªÅ m√† ph√°p lu·∫≠t kh√¥ng c·∫•m. Doanh nghi·ªáp c√≥ nghƒ©a v·ª• tu√¢n th·ªß c√°c quy ƒë·ªãnh v·ªÅ b·∫£o v·ªá m√¥i tr∆∞·ªùng, an to√†n lao ƒë·ªông, quy·ªÅn l·ª£i ng∆∞·ªùi lao ƒë·ªông.',
                        type: 'Lu·∫≠t',
                        source: 'Qu·ªëc h·ªôi',
                        date: '2020-06-17T00:00:00.000Z',
                        keywords: ['doanh nghi·ªáp', 'th√†nh l·∫≠p', 'qu·∫£n l√Ω', 'gi·∫£i th·ªÉ', 'kinh doanh', 'quy·ªÅn', 'nghƒ©a v·ª•'],
                        category: 'luat'
                    },
                    {
                        id: 'doc_3',
                        title: 'Lu·∫≠t Lao ƒë·ªông 2019',
                        content: 'Lu·∫≠t n√†y quy ƒë·ªãnh v·ªÅ quy·ªÅn v√† nghƒ©a v·ª• c·ªßa ng∆∞·ªùi lao ƒë·ªông, ng∆∞·ªùi s·ª≠ d·ª•ng lao ƒë·ªông, quan h·ªá lao ƒë·ªông v√† c√°c v·∫•n ƒë·ªÅ kh√°c li√™n quan ƒë·∫øn lao ƒë·ªông. Ng∆∞·ªùi lao ƒë·ªông c√≥ quy·ªÅn ƒë∆∞·ª£c b·∫£o v·ªá s·ª©c kh·ªèe, an to√†n lao ƒë·ªông, ƒë∆∞·ª£c tr·∫£ l∆∞∆°ng ƒë√∫ng th·ªùi h·∫°n, ƒë∆∞·ª£c ngh·ªâ ph√©p, ngh·ªâ l·ªÖ theo quy ƒë·ªãnh.',
                        type: 'Lu·∫≠t',
                        source: 'Qu·ªëc h·ªôi',
                        date: '2019-11-20T00:00:00.000Z',
                        keywords: ['lao ƒë·ªông', 'quy·ªÅn', 'nghƒ©a v·ª•', 'quan h·ªá lao ƒë·ªông', 'l∆∞∆°ng', 'ngh·ªâ ph√©p', 'an to√†n'],
                        category: 'luat'
                    },
                    {
                        id: 'doc_4',
                        title: 'Lu·∫≠t D√¢n s·ª± 2015',
                        content: 'Lu·∫≠t n√†y quy ƒë·ªãnh v·ªÅ quan h·ªá d√¢n s·ª±, bao g·ªìm quy·ªÅn s·ªü h·ªØu, quy·ªÅn th·ª´a k·∫ø, h·ª£p ƒë·ªìng d√¢n s·ª±, b·ªìi th∆∞·ªùng thi·ªát h·∫°i ngo√†i h·ª£p ƒë·ªìng. C√°c quy·ªÅn d√¢n s·ª± ƒë∆∞·ª£c b·∫£o v·ªá b·ªüi ph√°p lu·∫≠t v√† kh√¥ng ai ƒë∆∞·ª£c x√¢m ph·∫°m.',
                        type: 'Lu·∫≠t',
                        source: 'Qu·ªëc h·ªôi',
                        date: '2015-11-24T00:00:00.000Z',
                        keywords: ['d√¢n s·ª±', 's·ªü h·ªØu', 'th·ª´a k·∫ø', 'h·ª£p ƒë·ªìng', 'b·ªìi th∆∞·ªùng', 'quy·ªÅn'],
                        category: 'luat'
                    },
                    {
                        id: 'doc_5',
                        title: 'Lu·∫≠t H√¥n nh√¢n v√† Gia ƒë√¨nh 2014',
                        content: 'Lu·∫≠t n√†y quy ƒë·ªãnh v·ªÅ h√¥n nh√¢n v√† gia ƒë√¨nh; chu·∫©n m·ª±c ph√°p l√Ω cho c√°ch ·ª©ng x·ª≠ gi·ªØa c√°c th√†nh vi√™n gia ƒë√¨nh; quy·ªÅn, nghƒ©a v·ª• c·ªßa v·ª£, ch·ªìng, cha, m·∫π, con; tr√°ch nhi·ªám c·ªßa c√° nh√¢n, gia ƒë√¨nh, nh√† n∆∞·ªõc v√† x√£ h·ªôi trong vi·ªác x√¢y d·ª±ng, c·ªßng c·ªë ch·∫ø ƒë·ªô h√¥n nh√¢n v√† gia ƒë√¨nh.',
                        type: 'Lu·∫≠t',
                        source: 'Qu·ªëc h·ªôi',
                        date: '2014-06-19T00:00:00.000Z',
                        keywords: ['h√¥n nh√¢n', 'gia ƒë√¨nh', 'v·ª£ ch·ªìng', 'cha m·∫π', 'con c√°i', 'quy·ªÅn', 'nghƒ©a v·ª•'],
                        category: 'luat'
                    },
                    {
                        id: 'doc_6',
                        title: 'Lu·∫≠t H√¨nh s·ª± 2015',
                        content: 'Lu·∫≠t n√†y quy ƒë·ªãnh v·ªÅ t·ªôi ph·∫°m v√† h√¨nh ph·∫°t. T·ªôi ph·∫°m l√† h√†nh vi nguy hi·ªÉm cho x√£ h·ªôi ƒë∆∞·ª£c quy ƒë·ªãnh trong B·ªô lu·∫≠t H√¨nh s·ª±, do ng∆∞·ªùi c√≥ nƒÉng l·ª±c tr√°ch nhi·ªám h√¨nh s·ª± th·ª±c hi·ªán m·ªôt c√°ch c·ªë √Ω ho·∫∑c v√¥ √Ω, x√¢m ph·∫°m ƒë·ªôc l·∫≠p, ch·ªß quy·ªÅn, th·ªëng nh·∫•t v√† to√†n v·∫πn l√£nh th·ªï c·ªßa T·ªï qu·ªëc.',
                        type: 'Lu·∫≠t',
                        source: 'Qu·ªëc h·ªôi',
                        date: '2015-11-27T00:00:00.000Z',
                        keywords: ['h√¨nh s·ª±', 't·ªôi ph·∫°m', 'h√¨nh ph·∫°t', 'tr√°ch nhi·ªám', 'x√¢m ph·∫°m'],
                        category: 'luat'
                    },
                    {
                        id: 'doc_7',
                        title: 'Lu·∫≠t T·ªë t·ª•ng h√¨nh s·ª± 2015',
                        content: 'Lu·∫≠t n√†y quy ƒë·ªãnh v·ªÅ tr√¨nh t·ª±, th·ªß t·ª•c ti·∫øn h√†nh c√°c ho·∫°t ƒë·ªông kh·ªüi t·ªë, ƒëi·ªÅu tra, truy t·ªë, x√©t x·ª≠ v√† thi h√†nh √°n h√¨nh s·ª±; quy·ªÅn v√† nghƒ©a v·ª• c·ªßa nh·ªØng ng∆∞·ªùi tham gia t·ªë t·ª•ng; tr√°ch nhi·ªám c·ªßa c∆° quan, ng∆∞·ªùi c√≥ th·∫©m quy·ªÅn ti·∫øn h√†nh t·ªë t·ª•ng.',
                        type: 'Lu·∫≠t',
                        source: 'Qu·ªëc h·ªôi',
                        date: '2015-11-27T00:00:00.000Z',
                        keywords: ['t·ªë t·ª•ng', 'h√¨nh s·ª±', 'kh·ªüi t·ªë', 'ƒëi·ªÅu tra', 'truy t·ªë', 'x√©t x·ª≠'],
                        category: 'luat'
                    },
                    {
                        id: 'doc_8',
                        title: 'Lu·∫≠t T·ªë t·ª•ng d√¢n s·ª± 2015',
                        content: 'Lu·∫≠t n√†y quy ƒë·ªãnh v·ªÅ tr√¨nh t·ª±, th·ªß t·ª•c gi·∫£i quy·∫øt c√°c v·ª• √°n d√¢n s·ª±, h√¥n nh√¢n v√† gia ƒë√¨nh, kinh doanh, th∆∞∆°ng m·∫°i, lao ƒë·ªông v√† c√°c v·ª• vi·ªác d√¢n s·ª± kh√°c; quy·ªÅn v√† nghƒ©a v·ª• c·ªßa nh·ªØng ng∆∞·ªùi tham gia t·ªë t·ª•ng d√¢n s·ª±.',
                        type: 'Lu·∫≠t',
                        source: 'Qu·ªëc h·ªôi',
                        date: '2015-11-25T00:00:00.000Z',
                        keywords: ['t·ªë t·ª•ng', 'd√¢n s·ª±', 'gi·∫£i quy·∫øt', 'v·ª• √°n', 'h√¥n nh√¢n', 'kinh doanh'],
                        category: 'luat'
                    },
                    {
                        id: 'doc_9',
                        title: 'Lu·∫≠t ƒê·∫•t ƒëai 2013',
                        content: 'Lu·∫≠t n√†y quy ƒë·ªãnh v·ªÅ qu·∫£n l√Ω, s·ª≠ d·ª•ng ƒë·∫•t ƒëai; quy·ªÅn v√† nghƒ©a v·ª• c·ªßa ng∆∞·ªùi s·ª≠ d·ª•ng ƒë·∫•t; tr√°ch nhi·ªám c·ªßa Nh√† n∆∞·ªõc trong vi·ªác qu·∫£n l√Ω ƒë·∫•t ƒëai. ƒê·∫•t ƒëai thu·ªôc s·ªü h·ªØu to√†n d√¢n do Nh√† n∆∞·ªõc ƒë·∫°i di·ªán ch·ªß s·ªü h·ªØu v√† th·ªëng nh·∫•t qu·∫£n l√Ω.',
                        type: 'Lu·∫≠t',
                        source: 'Qu·ªëc h·ªôi',
                        date: '2013-11-29T00:00:00.000Z',
                        keywords: ['ƒë·∫•t ƒëai', 'qu·∫£n l√Ω', 's·ª≠ d·ª•ng', 'quy·ªÅn', 'nghƒ©a v·ª•', 's·ªü h·ªØu'],
                        category: 'luat'
                    },
                    {
                        id: 'doc_10',
                        title: 'Lu·∫≠t Nh√† ·ªü 2014',
                        content: 'Lu·∫≠t n√†y quy ƒë·ªãnh v·ªÅ quy·ªÅn s·ªü h·ªØu nh√† ·ªü, quy·ªÅn v√† nghƒ©a v·ª• c·ªßa ch·ªß s·ªü h·ªØu nh√† ·ªü, ng∆∞·ªùi s·ª≠ d·ª•ng nh√† ·ªü; qu·∫£n l√Ω nh√† ·ªü; ph√°t tri·ªÉn nh√† ·ªü; giao d·ªãch v·ªÅ nh√† ·ªü; b·∫£o tr√¨, s·ª≠a ch·ªØa nh√† ·ªü.',
                        type: 'Lu·∫≠t',
                        source: 'Qu·ªëc h·ªôi',
                        date: '2014-11-25T00:00:00.000Z',
                        keywords: ['nh√† ·ªü', 's·ªü h·ªØu', 'quy·ªÅn', 'nghƒ©a v·ª•', 'qu·∫£n l√Ω', 'ph√°t tri·ªÉn'],
                        category: 'luat'
                    },
                    {
                        id: 'doc_11',
                        title: 'Lu·∫≠t An ninh m·∫°ng 2018',
                        content: 'Lu·∫≠t n√†y quy ƒë·ªãnh v·ªÅ ho·∫°t ƒë·ªông b·∫£o v·ªá an ninh m·∫°ng; bi·ªán ph√°p b·∫£o v·ªá an ninh m·∫°ng; tr√°ch nhi·ªám c·ªßa c∆° quan, t·ªï ch·ª©c, c√° nh√¢n trong b·∫£o v·ªá an ninh m·∫°ng. B·∫£o v·ªá an ninh m·∫°ng l√† tr√°ch nhi·ªám c·ªßa to√†n d√¢n.',
                        type: 'Lu·∫≠t',
                        source: 'Qu·ªëc h·ªôi',
                        date: '2018-06-12T00:00:00.000Z',
                        keywords: ['an ninh', 'm·∫°ng', 'b·∫£o v·ªá', 'tr√°ch nhi·ªám', 'to√†n d√¢n'],
                        category: 'luat'
                    },
                    {
                        id: 'doc_12',
                        title: 'Lu·∫≠t B·∫£o hi·ªÉm x√£ h·ªôi 2014',
                        content: 'Lu·∫≠t n√†y quy ƒë·ªãnh v·ªÅ ch·∫ø ƒë·ªô, ch√≠nh s√°ch b·∫£o hi·ªÉm x√£ h·ªôi; quy·ªÅn v√† nghƒ©a v·ª• c·ªßa ng∆∞·ªùi lao ƒë·ªông, ng∆∞·ªùi s·ª≠ d·ª•ng lao ƒë·ªông ƒë·ªëi v·ªõi b·∫£o hi·ªÉm x√£ h·ªôi; quy·ªÅn v√† nghƒ©a v·ª• c·ªßa c∆° quan, t·ªï ch·ª©c, c√° nh√¢n c√≥ li√™n quan ƒë·∫øn b·∫£o hi·ªÉm x√£ h·ªôi.',
                        type: 'Lu·∫≠t',
                        source: 'Qu·ªëc h·ªôi',
                        date: '2014-11-20T00:00:00.000Z',
                        keywords: ['b·∫£o hi·ªÉm', 'x√£ h·ªôi', 'ch·∫ø ƒë·ªô', 'ch√≠nh s√°ch', 'quy·ªÅn', 'nghƒ©a v·ª•'],
                        category: 'luat'
                    },
                    
                    // NGH·ªä ƒê·ªäNH
                    {
                        id: 'doc_13',
                        title: 'Ngh·ªã ƒë·ªãnh 15/2020/Nƒê-CP v·ªÅ ch·ªëng d·ªãch COVID-19',
                        content: 'Ngh·ªã ƒë·ªãnh quy ƒë·ªãnh v·ªÅ c√°c bi·ªán ph√°p ph√≤ng, ch·ªëng d·ªãch b·ªánh COVID-19 v√† h·ªó tr·ª£ doanh nghi·ªáp, ng∆∞·ªùi d√¢n g·∫∑p kh√≥ khƒÉn do d·ªãch b·ªánh. C√°c bi·ªán ph√°p bao g·ªìm gi√£n c√°ch x√£ h·ªôi, ƒë√≥ng c·ª≠a c√°c c∆° s·ªü kinh doanh kh√¥ng thi·∫øt y·∫øu, h·ªó tr·ª£ t√†i ch√≠nh cho doanh nghi·ªáp v√† ng∆∞·ªùi lao ƒë·ªông.',
                        type: 'Ngh·ªã ƒë·ªãnh',
                        source: 'Ch√≠nh ph·ªß',
                        date: '2020-04-03T00:00:00.000Z',
                        keywords: ['covid-19', 'd·ªãch b·ªánh', 'h·ªó tr·ª£', 'doanh nghi·ªáp', 'gi√£n c√°ch', 't√†i ch√≠nh'],
                        category: 'nghi-dinh'
                    },
                    {
                        id: 'doc_14',
                        title: 'Ngh·ªã ƒë·ªãnh 100/2019/Nƒê-CP v·ªÅ x·ª≠ ph·∫°t vi ph·∫°m giao th√¥ng',
                        content: 'Ngh·ªã ƒë·ªãnh quy ƒë·ªãnh v·ªÅ x·ª≠ ph·∫°t vi ph·∫°m h√†nh ch√≠nh trong lƒ©nh v·ª±c giao th√¥ng ƒë∆∞·ªùng b·ªô, ƒë∆∞·ªùng s·∫Øt, ƒë∆∞·ªùng th·ªßy n·ªôi ƒë·ªãa, h√†ng h·∫£i, h√†ng kh√¥ng. C√°c m·ª©c ph·∫°t ƒë∆∞·ª£c quy ƒë·ªãnh c·ª• th·ªÉ cho t·ª´ng lo·∫°i vi ph·∫°m.',
                        type: 'Ngh·ªã ƒë·ªãnh',
                        source: 'Ch√≠nh ph·ªß',
                        date: '2019-12-30T00:00:00.000Z',
                        keywords: ['giao th√¥ng', 'x·ª≠ ph·∫°t', 'vi ph·∫°m', 'h√†nh ch√≠nh', 'ƒë∆∞·ªùng b·ªô', 'ƒë∆∞·ªùng s·∫Øt'],
                        category: 'nghi-dinh'
                    },
                    {
                        id: 'doc_15',
                        title: 'Ngh·ªã ƒë·ªãnh 15/2021/Nƒê-CP v·ªÅ qu·∫£n l√Ω thu·∫ø',
                        content: 'Ngh·ªã ƒë·ªãnh quy ƒë·ªãnh v·ªÅ qu·∫£n l√Ω thu·∫ø, bao g·ªìm ƒëƒÉng k√Ω thu·∫ø, khai thu·∫ø, n·ªôp thu·∫ø, quy·∫øt to√°n thu·∫ø, ho√†n thu·∫ø, mi·ªÖn thu·∫ø, gi·∫£m thu·∫ø, gia h·∫°n n·ªôp thu·∫ø, kh√¥ng thu thu·∫ø; quy·ªÅn v√† nghƒ©a v·ª• c·ªßa ng∆∞·ªùi n·ªôp thu·∫ø.',
                        type: 'Ngh·ªã ƒë·ªãnh',
                        source: 'Ch√≠nh ph·ªß',
                        date: '2021-03-03T00:00:00.000Z',
                        keywords: ['thu·∫ø', 'qu·∫£n l√Ω', 'ƒëƒÉng k√Ω', 'khai thu·∫ø', 'n·ªôp thu·∫ø', 'ho√†n thu·∫ø'],
                        category: 'nghi-dinh'
                    },
                    {
                        id: 'doc_16',
                        title: 'Ngh·ªã ƒë·ªãnh 15/2018/Nƒê-CP v·ªÅ b·∫£o v·ªá d·ªØ li·ªáu c√° nh√¢n',
                        content: 'Ngh·ªã ƒë·ªãnh quy ƒë·ªãnh v·ªÅ b·∫£o v·ªá d·ªØ li·ªáu c√° nh√¢n, quy·ªÅn ri√™ng t∆∞ c·ªßa c√° nh√¢n trong ho·∫°t ƒë·ªông x·ª≠ l√Ω d·ªØ li·ªáu c√° nh√¢n; tr√°ch nhi·ªám c·ªßa c∆° quan, t·ªï ch·ª©c, c√° nh√¢n trong vi·ªác b·∫£o v·ªá d·ªØ li·ªáu c√° nh√¢n.',
                        type: 'Ngh·ªã ƒë·ªãnh',
                        source: 'Ch√≠nh ph·ªß',
                        date: '2018-02-02T00:00:00.000Z',
                        keywords: ['d·ªØ li·ªáu', 'c√° nh√¢n', 'b·∫£o v·ªá', 'quy·ªÅn ri√™ng t∆∞', 'x·ª≠ l√Ω'],
                        category: 'nghi-dinh'
                    },
                    
                    // NGH·ªä QUY·∫æT
                    {
                        id: 'doc_17',
                        title: 'Ngh·ªã quy·∫øt 01/2021/NQ-CP v·ªÅ ch∆∞∆°ng tr√¨nh ph·ª•c h·ªìi kinh t·∫ø',
                        content: 'Ngh·ªã quy·∫øt v·ªÅ ch∆∞∆°ng tr√¨nh ph·ª•c h·ªìi v√† ph√°t tri·ªÉn kinh t·∫ø - x√£ h·ªôi, b·∫£o ƒë·∫£m an sinh x√£ h·ªôi, ·ª©ng ph√≥ v·ªõi bi·∫øn ƒë·ªïi kh√≠ h·∫≠u, ph√≤ng, ch·ªëng thi√™n tai, d·ªãch b·ªánh, b·∫£o ƒë·∫£m qu·ªëc ph√≤ng, an ninh.',
                        type: 'Ngh·ªã quy·∫øt',
                        source: 'Ch√≠nh ph·ªß',
                        date: '2021-01-01T00:00:00.000Z',
                        keywords: ['ph·ª•c h·ªìi', 'kinh t·∫ø', 'x√£ h·ªôi', 'an sinh', 'bi·∫øn ƒë·ªïi kh√≠ h·∫≠u'],
                        category: 'nghi-quyet'
                    },
                    {
                        id: 'doc_18',
                        title: 'Ngh·ªã quy·∫øt 128/2021/NQ-CP v·ªÅ th√≠ch ·ª©ng an to√†n v·ªõi COVID-19',
                        content: 'Ngh·ªã quy·∫øt v·ªÅ th√≠ch ·ª©ng an to√†n, linh ho·∫°t, ki·ªÉm so√°t hi·ªáu qu·∫£ d·ªãch COVID-19, t·∫°o ƒëi·ªÅu ki·ªán thu·∫≠n l·ª£i cho ph·ª•c h·ªìi v√† ph√°t tri·ªÉn kinh t·∫ø - x√£ h·ªôi.',
                        type: 'Ngh·ªã quy·∫øt',
                        source: 'Ch√≠nh ph·ªß',
                        date: '2021-10-11T00:00:00.000Z',
                        keywords: ['th√≠ch ·ª©ng', 'an to√†n', 'covid-19', 'linh ho·∫°t', 'ki·ªÉm so√°t'],
                        category: 'nghi-quyet'
                    },
                    
                    // TH√îNG T∆Ø
                    {
                        id: 'doc_19',
                        title: 'Th√¥ng t∆∞ 78/2021/TT-BTC v·ªÅ h∆∞·ªõng d·∫´n thu·∫ø',
                        content: 'Th√¥ng t∆∞ h∆∞·ªõng d·∫´n th·ª±c hi·ªán m·ªôt s·ªë ƒëi·ªÅu c·ªßa Lu·∫≠t Qu·∫£n l√Ω thu·∫ø v√† c√°c ngh·ªã ƒë·ªãnh li√™n quan v·ªÅ qu·∫£n l√Ω thu·∫ø, bao g·ªìm th·ªß t·ª•c ƒëƒÉng k√Ω thu·∫ø, khai thu·∫ø, n·ªôp thu·∫ø.',
                        type: 'Th√¥ng t∆∞',
                        source: 'B·ªô T√†i ch√≠nh',
                        date: '2021-09-15T00:00:00.000Z',
                        keywords: ['thu·∫ø', 'h∆∞·ªõng d·∫´n', 'qu·∫£n l√Ω', 'ƒëƒÉng k√Ω', 'khai thu·∫ø'],
                        category: 'thong-tu'
                    },
                    {
                        id: 'doc_20',
                        title: 'Th√¥ng t∆∞ 15/2021/TT-BLƒêTBXH v·ªÅ lao ƒë·ªông',
                        content: 'Th√¥ng t∆∞ h∆∞·ªõng d·∫´n th·ª±c hi·ªán m·ªôt s·ªë ƒëi·ªÅu c·ªßa B·ªô lu·∫≠t Lao ƒë·ªông v·ªÅ th·ªùi gi·ªù l√†m vi·ªác, th·ªùi gi·ªù ngh·ªâ ng∆°i, ti·ªÅn l∆∞∆°ng, an to√†n lao ƒë·ªông.',
                        type: 'Th√¥ng t∆∞',
                        source: 'B·ªô Lao ƒë·ªông - Th∆∞∆°ng binh v√† X√£ h·ªôi',
                        date: '2021-02-15T00:00:00.000Z',
                        keywords: ['lao ƒë·ªông', 'th·ªùi gi·ªù', 'ngh·ªâ ng∆°i', 'ti·ªÅn l∆∞∆°ng', 'an to√†n'],
                        category: 'thong-tu'
                    },
                    
                    // QUY·∫æT ƒê·ªäNH
                    {
                        id: 'doc_21',
                        title: 'Quy·∫øt ƒë·ªãnh 15/2020/Qƒê-TTg v·ªÅ h·ªó tr·ª£ doanh nghi·ªáp',
                        content: 'Quy·∫øt ƒë·ªãnh v·ªÅ m·ªôt s·ªë ch√≠nh s√°ch h·ªó tr·ª£ doanh nghi·ªáp, h·ª£p t√°c x√£, h·ªô kinh doanh g·∫∑p kh√≥ khƒÉn do ƒë·∫°i d·ªãch COVID-19, bao g·ªìm h·ªó tr·ª£ t√†i ch√≠nh, gi·∫£m thu·∫ø, gia h·∫°n n·ªôp thu·∫ø.',
                        type: 'Quy·∫øt ƒë·ªãnh',
                        source: 'Th·ªß t∆∞·ªõng Ch√≠nh ph·ªß',
                        date: '2020-04-24T00:00:00.000Z',
                        keywords: ['h·ªó tr·ª£', 'doanh nghi·ªáp', 'covid-19', 't√†i ch√≠nh', 'gi·∫£m thu·∫ø'],
                        category: 'quyet-dinh'
                    },
                    {
                        id: 'doc_22',
                        title: 'Quy·∫øt ƒë·ªãnh 15/2021/Qƒê-TTg v·ªÅ chuy·ªÉn ƒë·ªïi s·ªë',
                        content: 'Quy·∫øt ƒë·ªãnh v·ªÅ ch∆∞∆°ng tr√¨nh chuy·ªÉn ƒë·ªïi s·ªë qu·ªëc gia ƒë·∫øn nƒÉm 2025, ƒë·ªãnh h∆∞·ªõng ƒë·∫øn nƒÉm 2030, bao g·ªìm c√°c m·ª•c ti√™u, nhi·ªám v·ª•, gi·∫£i ph√°p chuy·ªÉn ƒë·ªïi s·ªë.',
                        type: 'Quy·∫øt ƒë·ªãnh',
                        source: 'Th·ªß t∆∞·ªõng Ch√≠nh ph·ªß',
                        date: '2021-06-03T00:00:00.000Z',
                        keywords: ['chuy·ªÉn ƒë·ªïi s·ªë', 'qu·ªëc gia', 'm·ª•c ti√™u', 'nhi·ªám v·ª•', 'gi·∫£i ph√°p'],
                        category: 'quyet-dinh'
                    },
                    
                    // CH·ªà TH·ªä
                    {
                        id: 'doc_23',
                        title: 'Ch·ªâ th·ªã 15/CT-TTg v·ªÅ ph√≤ng ch·ªëng COVID-19',
                        content: 'Ch·ªâ th·ªã v·ªÅ vi·ªác th·ª±c hi·ªán c√°c bi·ªán ph√°p c·∫•p b√°ch ph√≤ng, ch·ªëng d·ªãch COVID-19, bao g·ªìm gi√£n c√°ch x√£ h·ªôi, ƒë√≥ng c·ª≠a c√°c c∆° s·ªü kh√¥ng thi·∫øt y·∫øu, tƒÉng c∆∞·ªùng ki·ªÉm tra, gi√°m s√°t.',
                        type: 'Ch·ªâ th·ªã',
                        source: 'Th·ªß t∆∞·ªõng Ch√≠nh ph·ªß',
                        date: '2020-03-27T00:00:00.000Z',
                        keywords: ['covid-19', 'ph√≤ng ch·ªëng', 'gi√£n c√°ch', 'ki·ªÉm tra', 'gi√°m s√°t'],
                        category: 'chi-thi'
                    },
                    {
                        id: 'doc_24',
                        title: 'Ch·ªâ th·ªã 16/CT-TTg v·ªÅ chuy·ªÉn ƒë·ªïi s·ªë',
                        content: 'Ch·ªâ th·ªã v·ªÅ vi·ªác tƒÉng c∆∞·ªùng nƒÉng l·ª±c ti·∫øp c·∫≠n cu·ªôc C√°ch m·∫°ng c√¥ng nghi·ªáp l·∫ßn th·ª© t∆∞, th√∫c ƒë·∫©y chuy·ªÉn ƒë·ªïi s·ªë qu·ªëc gia.',
                        type: 'Ch·ªâ th·ªã',
                        source: 'Th·ªß t∆∞·ªõng Ch√≠nh ph·ªß',
                        date: '2020-05-04T00:00:00.000Z',
                        keywords: ['c√°ch m·∫°ng', 'c√¥ng nghi·ªáp', 'chuy·ªÉn ƒë·ªïi s·ªë', 'nƒÉng l·ª±c', 'ti·∫øp c·∫≠n'],
                        category: 'chi-thi'
                    },
                    
                    // H·ª¢P ƒê·ªíNG M·∫™U
                    {
                        id: 'doc_25',
                        title: 'H·ª£p ƒë·ªìng lao ƒë·ªông m·∫´u',
                        content: 'H·ª£p ƒë·ªìng lao ƒë·ªông l√† s·ª± th·ªèa thu·∫≠n gi·ªØa ng∆∞·ªùi lao ƒë·ªông v√† ng∆∞·ªùi s·ª≠ d·ª•ng lao ƒë·ªông v·ªÅ vi·ªác l√†m c√≥ tr·∫£ c√¥ng, ƒëi·ªÅu ki·ªán lao ƒë·ªông, quy·ªÅn v√† nghƒ©a v·ª• c·ªßa m·ªói b√™n trong quan h·ªá lao ƒë·ªông.',
                        type: 'H·ª£p ƒë·ªìng m·∫´u',
                        source: 'B·ªô Lao ƒë·ªông - Th∆∞∆°ng binh v√† X√£ h·ªôi',
                        date: '2021-01-01T00:00:00.000Z',
                        keywords: ['h·ª£p ƒë·ªìng', 'lao ƒë·ªông', 'th·ªèa thu·∫≠n', 'vi·ªác l√†m', 'tr·∫£ c√¥ng'],
                        category: 'hop-dong'
                    },
                    {
                        id: 'doc_26',
                        title: 'H·ª£p ƒë·ªìng mua b√°n nh√† ·ªü',
                        content: 'H·ª£p ƒë·ªìng mua b√°n nh√† ·ªü l√† s·ª± th·ªèa thu·∫≠n gi·ªØa c√°c b√™n, theo ƒë√≥ b√™n b√°n chuy·ªÉn quy·ªÅn s·ªü h·ªØu nh√† ·ªü cho b√™n mua v√† b√™n mua tr·∫£ ti·ªÅn cho b√™n b√°n.',
                        type: 'H·ª£p ƒë·ªìng m·∫´u',
                        source: 'B·ªô X√¢y d·ª±ng',
                        date: '2021-01-01T00:00:00.000Z',
                        keywords: ['h·ª£p ƒë·ªìng', 'mua b√°n', 'nh√† ·ªü', 's·ªü h·ªØu', 'chuy·ªÉn quy·ªÅn'],
                        category: 'hop-dong'
                    },
                    {
                        id: 'doc_27',
                        title: 'H·ª£p ƒë·ªìng thu√™ nh√†',
                        content: 'H·ª£p ƒë·ªìng thu√™ nh√† l√† s·ª± th·ªèa thu·∫≠n gi·ªØa b√™n cho thu√™ v√† b√™n thu√™, theo ƒë√≥ b√™n cho thu√™ giao nh√† cho b√™n thu√™ s·ª≠ d·ª•ng trong m·ªôt th·ªùi h·∫°n nh·∫•t ƒë·ªãnh v√† b√™n thu√™ tr·∫£ ti·ªÅn thu√™ nh√†.',
                        type: 'H·ª£p ƒë·ªìng m·∫´u',
                        source: 'B·ªô X√¢y d·ª±ng',
                        date: '2021-01-01T00:00:00.000Z',
                        keywords: ['h·ª£p ƒë·ªìng', 'thu√™ nh√†', 'th·ªèa thu·∫≠n', 's·ª≠ d·ª•ng', 'ti·ªÅn thu√™'],
                        category: 'hop-dong'
                    },
                    {
                        id: 'doc_28',
                        title: 'H·ª£p ƒë·ªìng cung c·∫•p d·ªãch v·ª•',
                        content: 'H·ª£p ƒë·ªìng cung c·∫•p d·ªãch v·ª• l√† s·ª± th·ªèa thu·∫≠n gi·ªØa c√°c b√™n, theo ƒë√≥ b√™n cung c·∫•p d·ªãch v·ª• th·ª±c hi·ªán c√¥ng vi·ªác cho b√™n s·ª≠ d·ª•ng d·ªãch v·ª• v√† b√™n s·ª≠ d·ª•ng d·ªãch v·ª• tr·∫£ ti·ªÅn c√¥ng.',
                        type: 'H·ª£p ƒë·ªìng m·∫´u',
                        source: 'B·ªô T∆∞ ph√°p',
                        date: '2021-01-01T00:00:00.000Z',
                        keywords: ['h·ª£p ƒë·ªìng', 'd·ªãch v·ª•', 'cung c·∫•p', 'th·ªèa thu·∫≠n', 'ti·ªÅn c√¥ng'],
                        category: 'hop-dong'
                    },
                    {
                        id: 'doc_29',
                        title: 'H·ª£p ƒë·ªìng vay ti·ªÅn',
                        content: 'H·ª£p ƒë·ªìng vay ti·ªÅn l√† s·ª± th·ªèa thu·∫≠n gi·ªØa c√°c b√™n, theo ƒë√≥ b√™n cho vay giao ti·ªÅn cho b√™n vay v√† b√™n vay c√≥ nghƒ©a v·ª• ho√†n tr·∫£ ti·ªÅn g·ªëc v√† l√£i cho b√™n cho vay.',
                        type: 'H·ª£p ƒë·ªìng m·∫´u',
                        source: 'B·ªô T∆∞ ph√°p',
                        date: '2021-01-01T00:00:00.000Z',
                        keywords: ['h·ª£p ƒë·ªìng', 'vay ti·ªÅn', 'th·ªèa thu·∫≠n', 'ho√†n tr·∫£', 'l√£i'],
                        category: 'hop-dong'
                    },
                    {
                        id: 'doc_30',
                        title: 'H·ª£p ƒë·ªìng ·ªßy quy·ªÅn',
                        content: 'H·ª£p ƒë·ªìng ·ªßy quy·ªÅn l√† s·ª± th·ªèa thu·∫≠n gi·ªØa c√°c b√™n, theo ƒë√≥ b√™n ƒë∆∞·ª£c ·ªßy quy·ªÅn c√≥ nghƒ©a v·ª• th·ª±c hi·ªán c√¥ng vi·ªác nh√¢n danh b√™n ·ªßy quy·ªÅn v√† b√™n ·ªßy quy·ªÅn ch·ªâ ph·∫£i tr·∫£ th√π lao n·∫øu c√≥ th·ªèa thu·∫≠n ho·∫∑c ph√°p lu·∫≠t c√≥ quy ƒë·ªãnh.',
                        type: 'H·ª£p ƒë·ªìng m·∫´u',
                        source: 'B·ªô T∆∞ ph√°p',
                        date: '2021-01-01T00:00:00.000Z',
                        keywords: ['h·ª£p ƒë·ªìng', '·ªßy quy·ªÅn', 'th·ªèa thu·∫≠n', 'th·ª±c hi·ªán', 'th√π lao'],
                        category: 'hop-dong'
                    }
                ];
            }
            
            toggleRecording() {
                this.isRecording = !this.isRecording;
                this.recordBtn.classList.toggle('active', this.isRecording);
                
                if (this.isRecording) {
                    this.recordBtn.innerHTML = '<i data-lucide="mic-off" class="w-5 h-5"></i>';
                    // Start recording logic here
                } else {
                    this.recordBtn.innerHTML = '<i data-lucide="mic" class="w-5 h-5"></i>';
                    // Stop recording logic here
                }
            }
            
            filterSuggestions(category) {
                this.selectedCategory = category;
                const suggestions = this.suggestionsList.querySelectorAll('.suggestion-item');
                
                suggestions.forEach(suggestion => {
                    const suggestionCategory = suggestion.dataset.category;
                    if (category === 'all' || suggestionCategory === category) {
                        suggestion.style.display = 'block';
                    } else {
                        suggestion.style.display = 'none';
                    }
                });
            }
            
            copyMessage(messageId) {
                const message = this.messages.find(m => m.id === messageId);
                if (message) {
                    navigator.clipboard.writeText(message.content);
                    alert('ƒê√£ sao ch√©p tin nh·∫Øn');
                }
            }
            
            shareMessage(messageId) {
                const message = this.messages.find(m => m.id === messageId);
                if (message) {
                    if (navigator.share) {
                        navigator.share({
                            title: 'ViLaw Chat',
                            text: message.content,
                            url: window.location.href
                        });
                    } else {
                        navigator.clipboard.writeText(message.content);
                        alert('ƒê√£ sao ch√©p ƒë·ªÉ chia s·∫ª');
                    }
                }
            }
            
            scrollToBottom() {
                this.messagesContainer.scrollTop = this.messagesContainer.scrollHeight;
            }
        }
        
        // Initialize chat app
        let chatApp;
        
        // Simple initialization
        function initChat() {
            if (!chatApp) {
                console.log('Initializing ChatApp...');
                chatApp = new ChatApp();
                console.log('ChatApp initialized:', chatApp);
            }
        }
        
        // Initialize when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initChat);
        } else {
            initChat();
        }
        
        // Also try to initialize after a short delay
        setTimeout(initChat, 100);
        
        // Global function for manual testing
        window.testChat = function() {
            console.log('Testing chat functionality...');
            if (chatApp) {
                console.log('ChatApp is initialized');
                chatApp.addMessage('user', 'Test message');
            } else {
                console.log('ChatApp not initialized, trying to initialize...');
                chatApp = new ChatApp();
            }
        };
        
        // Debug function
        window.debugChat = function() {
            console.log('ChatApp status:', chatApp);
            console.log('Messages container:', document.getElementById('messagesContainer'));
            console.log('Message input:', document.getElementById('messageInput'));
            console.log('Send button:', document.getElementById('sendBtn'));
        };
        
        // Force send message function
        window.forceSend = function(message) {
            if (chatApp) {
                chatApp.addMessage('user', message);
                chatApp.generateAIResponse(message);
            } else {
                console.log('ChatApp not initialized');
            }
        };
        
        // Manual send function
        window.manualSend = function() {
            const input = document.getElementById('messageInput');
            if (input && chatApp) {
                const content = input.value.trim();
                if (content) {
                    chatApp.sendMessage();
                }
            }
        };
    </script>
</body>
</html>
