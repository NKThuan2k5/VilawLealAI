<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Chat - ViLaw</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        .chat-container {
            border: 1px solid #ddd;
            border-radius: 10px;
            height: 400px;
            overflow-y: auto;
            padding: 20px;
            margin-bottom: 20px;
        }
        .message {
            margin-bottom: 10px;
            padding: 10px;
            border-radius: 5px;
        }
        .user {
            background-color: #e3f2fd;
            text-align: right;
        }
        .ai {
            background-color: #f5f5f5;
        }
        .input-container {
            display: flex;
            gap: 10px;
        }
        .input-field {
            flex: 1;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .send-button {
            padding: 10px 20px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        .send-button:hover {
            background-color: #45a049;
        }
        .debug-info {
            background-color: #f0f0f0;
            padding: 10px;
            border-radius: 5px;
            margin-top: 20px;
            font-family: monospace;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <h1>Test Chat ViLaw</h1>
    
    <div class="chat-container" id="chatContainer">
        <div class="message ai">
            <strong>AI:</strong> Xin chào! Tôi là trợ lý pháp lý AI của ViLaw. Bạn có thể hỏi tôi bất cứ điều gì về pháp luật Việt Nam.
        </div>
    </div>
    
    <div class="input-container">
        <input type="text" id="messageInput" class="input-field" placeholder="Nhập câu hỏi của bạn...">
        <button id="sendButton" class="send-button">Gửi</button>
    </div>
    
    <div class="debug-info" id="debugInfo">
        <strong>Debug Info:</strong><br>
        <span id="debugText">Chờ khởi tạo...</span>
    </div>
    
    <script>
        class SimpleChat {
            constructor() {
                this.chatContainer = document.getElementById('chatContainer');
                this.messageInput = document.getElementById('messageInput');
                this.sendButton = document.getElementById('sendButton');
                this.debugText = document.getElementById('debugText');
                
                this.init();
            }
            
            init() {
                console.log('Initializing SimpleChat...');
                this.debugText.textContent = 'Chat đã khởi tạo thành công!';
                
                this.sendButton.addEventListener('click', () => this.sendMessage());
                this.messageInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        this.sendMessage();
                    }
                });
                
                console.log('SimpleChat initialized successfully');
            }
            
            sendMessage() {
                const message = this.messageInput.value.trim();
                if (!message) return;
                
                console.log('Sending message:', message);
                
                // Add user message
                this.addMessage('user', message);
                this.messageInput.value = '';
                
                // Simulate AI response
                setTimeout(() => {
                    this.addMessage('ai', this.generateResponse(message));
                }, 1000);
            }
            
            addMessage(type, content) {
                const messageDiv = document.createElement('div');
                messageDiv.className = `message ${type}`;
                
                if (type === 'user') {
                    messageDiv.innerHTML = `<strong>Bạn:</strong> ${content}`;
                } else {
                    messageDiv.innerHTML = `<strong>AI:</strong> ${content}`;
                }
                
                this.chatContainer.appendChild(messageDiv);
                this.chatContainer.scrollTop = this.chatContainer.scrollHeight;
            }
            
            generateResponse(userMessage) {
                const responses = [
                    'Dựa trên pháp luật Việt Nam, tôi có thể giúp bạn hiểu rõ hơn về vấn đề này.',
                    'Đây là một câu hỏi pháp lý quan trọng. Tôi khuyên bạn nên tham khảo ý kiến của luật sư chuyên nghiệp.',
                    'Cảm ơn bạn đã đặt câu hỏi. Để đảm bảo tính chính xác, tôi khuyên bạn nên tham khảo văn bản pháp luật chính thức.',
                    'Đây là một vấn đề pháp lý phức tạp. Tôi khuyên bạn nên tìm hiểu thêm thông tin từ các nguồn chính thức.',
                    'Theo quy định hiện hành, tôi có thể cung cấp thông tin tham khảo về vấn đề này.'
                ];
                
                return responses[Math.floor(Math.random() * responses.length)];
            }
        }
        
        // Initialize chat when page loads
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM loaded, initializing chat...');
            const chat = new SimpleChat();
            console.log('Chat initialized:', chat);
        });
        
        // Fallback initialization
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', function() {
                console.log('Initializing chat on DOMContentLoaded');
            });
        } else {
            console.log('DOM already loaded, initializing chat immediately');
            const chat = new SimpleChat();
        }
    </script>
</body>
</html>
